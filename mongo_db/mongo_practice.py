from pymongo import MongoClient

# 1Ô∏è‚É£ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ª–æ–∫–∞–ª—å–Ω–æ–º—É —Å–µ—Ä–≤–µ—Ä—É MongoDB
client = MongoClient("mongodb://localhost:27017/")

# 2Ô∏è‚É£ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –±–∞–∑–µ –∏ –∫–æ–ª–ª–µ–∫—Ü–∏–∏
db = client["people_database"]
collection = db["users"]

# 3Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∫–∞–∫–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã —É–∂–µ –µ—Å—Ç—å
print("üìã –¢–µ–∫—É—â–∏–µ –∑–∞–ø–∏—Å–∏ –≤ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ users:")
for user in collection.find():
    print(user)

# 4Ô∏è‚É£ –ò—â–µ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ –∏–º–µ–Ω–∏ (–ø—Ä–∏–º–µ—Ä: –ò–≤–∞–Ω)
print("\nüîç –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –∏–º–µ–Ω–µ–º '–ò–≤–∞–Ω':")
user = collection.find_one({"first_name": "–ò–≤–∞–Ω"})
if user:
    print("–ù–∞–π–¥–µ–Ω:", user)
else:
    print("–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å –∏–º–µ–Ω–µ–º '–ò–≤–∞–Ω' –Ω–µ –Ω–∞–π–¥–µ–Ω.")

# 5Ô∏è‚É£ –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω ‚Äî –æ–±–Ω–æ–≤–∏–º –µ–≥–æ email
if user:
    new_email = "ivan.petrov@newmail.com"
    update_result = collection.update_one(
        {"first_name": "–ò–≤–∞–Ω"},                  # —Ñ–∏–ª—å—Ç—Ä
        {"$set": {"email": new_email}}           # –Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
    )
    if update_result.modified_count > 0:
        print(f"\n‚úÖ Email –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è '–ò–≤–∞–Ω' –∏–∑–º–µ–Ω—ë–Ω –Ω–∞ {new_email}")
    else:
        print("\n‚ö†Ô∏è –î–∞–Ω–Ω—ã–µ —É–∂–µ –±—ã–ª–∏ –∞–∫—Ç—É–∞–ª—å–Ω—ã–º–∏ ‚Äî –∏–∑–º–µ–Ω–µ–Ω–∏–π –Ω–µ—Ç.")

# 6Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∏–º –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
print("\nüìÑ –î–∞–Ω–Ω—ã–µ –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:")
for user in collection.find():
    print(user)
